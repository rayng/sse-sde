
# Not for beta doubling.

import numpy as np
import matplotlib.pyplot as plt



L=8
nmax=10
nobs=13
sys=str(L)+"x"+str(L)
beta=L
N=L*L
hh=np.arange(1,3.25,0.25)
samples = 1000
print hh


for h in np.arange(0,8):
    fn=np.loadtxt("../data/"+sys+"/DIST/"+sys+"h"+str(h)+"p0beta0autocorr",unpack=True)  #unpack sorts it according to columns
    
    rho_col=(0)*nobs+7
    rhosq_col=(0)*nobs+8
    m_col =(0)*nobs+3
    msq_col = (0)*nobs+4
    plt.subplot(1,1,1)
    plt.title('Stiffness')
    rhoerr=1/np.sqrt(samples) * ( pow(np.pi/beta,2)*fn[rhosq_col] - fn[rho_col]*fn[rho_col] )
    #print np.shape(fn)

    stiff = fn[rho_col]
    result = np.correlate(stiff, stiff, mode='full')
    #result2 = result[result.size/2:]
    
    plt.plot ( np.arange(0,len(result)), result )

    plt.show()
    #print len(rhoerr)
    
"""
    plt.errorbar([hh[h]], [fn[rho_col]], yerr=rhoerr, c='r', marker='o')
    plt.subplot(1,2,2)
    comp = 1.*beta*N*(fn[msq_col] - fn[m_col]*fn[m_col] )
    print h, comp
    plt.title('Compressibility')
    plt.scatter([hh[h]], [comp], c='b')
"""
    
    #plt.show()
#plt.show()
    
    
    
